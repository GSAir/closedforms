# prog: {
    Assign(x,New(A))
    Put(Ref(x),Const(a),New(A2))
    Put(Get(Ref(x),Const(a)),Const(baz),Const(3))
    If(Direct("input"),{
      Put(Ref(x),Const(a),New(B))
      Put(Get(Ref(x),Const(a)),Const(foo),Const(5))
    },{
      Put(Ref(x),Const(a),New(C))
      Put(Get(Ref(x),Const(a)),Const(bar),Const(5))
    })
    Put(Get(Ref(x),Const(a)),Const(bar),Const(7))
    Assign(xbar,Get(Get(Ref(x),Const(a)),Const(bar)))
  }
# eval:
  val x0 = Map()
  val x1 = Map("top" -> Map())
  val x2 = Map("A" -> x1)
  val x3 = Map("val" -> (A,top))
  val x4 = Map("A" -> x1, "&x" -> x3)
  val x5 = Map("A" -> x1, "&x" -> x3, "A2" -> x1)
  val x6 = Map("a" -> (A2,top))
  val x7 = Map("top" -> x6)
  val x8 = Map("A" -> x7, "&x" -> x3)
  val x9 = Map("baz" -> 3)
  val x10 = Map("top" -> x9)
  val x11 = Map("A" -> x7, "&x" -> x3, "A2" -> x10)
  val x12 = Map("A" -> x7, "&x" -> x3, "A2" -> x10, "B" -> x1)
  val x13 = Map("a" -> (B,top))
  val x14 = Map("top" -> x13)
  val x15 = Map("A" -> x14, "&x" -> x3, "A2" -> x10)
  val x16 = Map("foo" -> 5)
  val x17 = Map("top" -> x16)
  val x18 = Map("A" -> x14, "&x" -> x3, "A2" -> x10, "B" -> x17)
  val x19 = Map("A" -> x7, "&x" -> x3, "A2" -> x10, "C" -> x1)
  val x20 = Map("a" -> (C,top))
  val x21 = Map("top" -> x20)
  val x22 = Map("A" -> x21, "&x" -> x3, "A2" -> x10)
  val x23 = Map("bar" -> 5)
  val x24 = Map("top" -> x23)
  val x25 = Map("A" -> x21, "&x" -> x3, "A2" -> x10, "C" -> x24)
  val x26 = Map("foo" -> 5, "bar" -> 7)
  val x27 = Map("top" -> x26)
  val x28 = Map("A" -> x14, "&x" -> x3, "A2" -> x10, "B" -> x27)
  val x29 = Map("val" -> 7)
  val x30 = Map("A2" -> x10, "&x" -> x3, "&xbar" -> x29, "B" -> x27, "A" -> x14)
# result:
  res: ()
  store: x30
  transformed: x30
  ## sched:
    val x29 = Map("val" -> 7)
    val x26 = Map("foo" -> 5, "bar" -> 7)
    val x27 = Map("top" -> x26)
    val x13 = Map("a" -> (B,top))
    val x14 = Map("top" -> x13)
    val x9 = Map("baz" -> 3)
    val x10 = Map("top" -> x9)
    val x3 = Map("val" -> (A,top))
    val x30 = Map("A2" -> x10, "&x" -> x3, "&xbar" -> x29, "B" -> x27, "A" -> x14)
  ## term:
    Map("B" -> Map("top" -> Map("foo" -> 5, "bar" -> 7)), "A2" -> Map("top" -> Map("baz" -> 3)), "A" -> Map("top" -> Map("a" -> (B,top))), "&x" -> Map("val" -> (A,top)), "&xbar" -> Map("val" -> 7))
# done
